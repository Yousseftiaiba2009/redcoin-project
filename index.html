<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redcoin RTC | Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</title>
    <style>
        :root {
            --red-main: #9e0d0d;
            --neon-glow: #ff2b2b;
            --gold: #ffd700;
            --dark-space: #050505;
            --card-bg: #111;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background-color: var(--dark-space);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; padding-bottom: 80px;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .coin-box {
            position: relative; width: 200px; height: 200px;
            margin-top: 30px; display: flex; align-items: center; justify-content: center;
        }
        .coin-visual {
            width: 160px; height: 160px;
            background: radial-gradient(circle, var(--neon-glow) 0%, var(--red-main) 100%);
            border-radius: 50%; border: 5px double var(--gold);
            box-shadow: 0 0 35px rgba(255, 43, 43, 0.4);
            display: flex; align-items: center; justify-content: center;
            animation: pulse 2.5s infinite ease-in-out;
        }
        .coin-letter { font-size: 90px; font-weight: bold; color: var(--gold); }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(255, 43, 43, 0.3); }
            50% { transform: scale(1.03); box-shadow: 0 0 55px rgba(255, 43, 43, 0.6); }
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .dashboard {
            background: var(--card-bg); border: 1px solid var(--red-main);
            border-radius: 20px; padding: 20px; width: 90%; max-width: 450px;
            margin-top: 20px; text-align: center;
        }
        .user-addr { font-size: 0.7rem; color: #888; background: #000; padding: 5px; border-radius: 5px; word-break: break-all; margin: 10px 0; }
        .balance-val { font-size: 2.5rem; font-weight: bold; color: var(--neon-glow); }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
        .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .btn {
            background: none; border: 1px solid var(--gold); color: var(--gold);
            padding: 12px; border-radius: 10px; cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        .btn:hover { background: var(--gold); color: black; }
        .btn.primary { background: var(--red-main); border: none; color: white; }

        /* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; padding: 20px; }
        .modal-content { background: var(--card-bg); border: 1px solid var(--gold); padding: 20px; border-radius: 15px; width: 100%; max-width: 400px; margin: 100px auto; }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #222; border: 1px solid #444; color: white; border-radius: 8px; }

        .footer-nav { position: fixed; bottom: 0; width: 100%; background: #111; display: flex; justify-content: space-around; padding: 15px; border-top: 1px solid #333; }
    </style>
</head>
<body>

    <div class="coin-box">
        <div class="coin-visual"><span class="coin-letter">R</span></div>
    </div>

    <div class="dashboard" id="main-ui">
        <p>Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ©...</p>
    </div>

    <div id="sendModal" class="modal">
        <div class="modal-content">
            <h3>Ø¥Ø±Ø³Ø§Ù„ RTC</h3>
            <input type="text" id="target-address" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ„Ù…">
            <input type="number" id="send-amount" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
            <input type="password" id="private-key" placeholder="Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø®Ø§Øµ Ù„Ù„ØªØ£ÙƒÙŠØ¯">
            <button class="btn primary" onclick="processSend()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</button>
            <button class="btn" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
            <input type="password" id="login-key" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø®Ø§Øµ">
            <button class="btn primary" onclick="processLogin()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
            <button class="btn" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script>
        const API = 'https://rtc-miner-server.onrender.com';
        let currentUser = localStorage.getItem('rtc_user_addr') || null;

        async function updateUI() {
            const dashboard = document.getElementById('main-ui');
            
            if (currentUser) {
                // ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¬Ù„
                try {
                    const res = await fetch(`${API}/balance/${currentUser}`);
                    const data = await res.json();
                    dashboard.innerHTML = `
                        <div class="user-addr">${currentUser}</div>
                        <div class="balance-val">${parseFloat(data.balance).toFixed(6)} RTC</div>
                        <div class="action-grid">
                            <button class="btn primary" onclick="openModal('sendModal')">Ø¥Ø±Ø³Ø§Ù„</button>
                            <button class="btn" onclick="alert('Ø¹Ù†ÙˆØ§Ù†Ùƒ Ù‡Ùˆ: '+currentUser)">Ø§Ø³ØªÙ„Ø§Ù…</button>
                        </div>
                        <button class="btn" style="margin-top:15px; width:100%; border-color:#555; color:#888;" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                    `;
                } catch (e) { dashboard.innerHTML = "<p>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±</p>"; }
            } else {
                // ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø²Ø§Ø¦Ø±
                dashboard.innerHTML = `
                    <h3>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Redcoin</h3>
                    <p style="color:#888; margin:10px 0;">Ø£ÙˆÙ„ Ø¹Ù…Ù„Ø© Ø±Ù‚Ù…ÙŠØ© Ù…Ø¨Ù†ÙŠØ© Ù„Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø³Ø±Ø¹Ø©</p>
                    <div class="action-grid" style="grid-template-columns: 1fr;">
                        <button class="btn primary" onclick="createNewWallet()">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙØ¸Ø© Ø¬Ø¯ÙŠØ¯Ø© âœ¨</button>
                        <button class="btn" onclick="openModal('loginModal')">Ù„Ø¯ÙŠ Ù…Ø­ÙØ¸Ø© Ø¨Ø§Ù„ÙØ¹Ù„ (Ø¯Ø®ÙˆÙ„)</button>
                    </div>
                `;
            }
        }

        async function createNewWallet() {
            const res = await fetch(`${API}/create_wallet`);
            const data = await res.json();
            alert(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙØ¸ØªÙƒ!\n\nØ§Ù„Ø¹Ù†ÙˆØ§Ù†: ${data.address}\nØ§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø®Ø§Øµ: ${data.private_key}\n\nâš ï¸ Ù‡Ø§Ù…: Ø§Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø®Ø§Øµ ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù†ØŒ Ù„Ù† ÙŠØ¸Ù‡Ø± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!`);
            currentUser = data.address;
            localStorage.setItem('rtc_user_addr', data.address);
            updateUI();
        }

        async function processLogin() {
            const key = document.getElementById('login-key').value;
            const res = await fetch(`${API}/login`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ private_key: key })
            });
            const data = await res.json();
            if (data.address) {
                currentUser = data.address;
                localStorage.setItem('rtc_user_addr', data.address);
                closeModal();
                updateUI();
            } else { alert("Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø®Ø§Øµ ØºÙŠØ± ØµØ­ÙŠØ­!"); }
        }

        async function processSend() {
            const to = document.getElementById('target-address').value;
            const amount = document.getElementById('send-amount').value;
            const key = document.getElementById('private-key').value;
            
            const res = await fetch(`${API}/send?from=${currentUser}&key=${key}&to=${to}&amount=${amount}`);
            const data = await res.json();
            
            if (data.status === "Success") {
                alert("ğŸš€ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!");
                closeModal();
                updateUI();
            } else { alert("âŒ Ø®Ø·Ø£: " + data.error); }
        }

        function openModal(id) { document.getElementById(id).style.display = 'block'; }
        function closeModal() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }
        function logout() { localStorage.removeItem('rtc_user_addr'); currentUser = null; updateUI(); }

        updateUI();
        setInterval(updateUI, 10000); // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†Ù
    </script>
</body>
</html>
